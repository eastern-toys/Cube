<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                      http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!-- This is core functionality, so you shouldn't need to touch it-->
    <bean id="top" class="org.restlet.ext.spring.SpringComponent">
        <property name="server">
            <bean class="org.restlet.ext.spring.SpringServer">
                <constructor-arg value="http"/>
                <constructor-arg value="8182"/>
            </bean>
        </property>
        <property name="defaultTarget" ref="root"/>
    </bean>

    <bean id="root" class="org.restlet.ext.spring.SpringRouter">
        <property name="attachments">
            <map>
                <entry key="/submissions">
                    <bean class="org.restlet.ext.spring.SpringFinder">
                        <lookup-method name="create" bean="submissionsResource"/>
                    </bean>
                </entry>
                <entry key="/submissions/{id}">
                    <bean class="org.restlet.ext.spring.SpringFinder">
                        <lookup-method name="create" bean="submissionResource"/>
                    </bean>
                </entry>
                <entry key="/visibilities/{teamId}/{puzzleId}">
                    <bean class="org.restlet.ext.spring.SpringFinder">
                        <lookup-method name="create" bean="visibilityResource"/>
                    </bean>
                </entry>
                <entry key="/visibilities">
                    <bean class="org.restlet.ext.spring.SpringFinder">
                        <lookup-method name="create" bean="visibilitiesResource"/>
                    </bean>
                </entry>
                <entry key="/events">
                    <bean class="org.restlet.ext.spring.SpringFinder">
                        <lookup-method name="create" bean="eventsResource"/>
                    </bean>
                </entry>
                <entry key="/teams/{id}">
                    <bean class="org.restlet.ext.spring.SpringFinder">
                        <lookup-method name="create" bean="teamResource"/>
                    </bean>
                </entry>
            </map>
        </property>
    </bean>

    <bean id="submissionsResource" class="edu.mit.puzzle.cube.core.serverresources.SubmissionsResource" scope="prototype">
        <constructor-arg name="submissionStore" ref="submissionStore"/>
        <constructor-arg name="huntStatusStore" ref="huntStatusStore"/>
    </bean>

    <bean id="submissionResource" class="edu.mit.puzzle.cube.core.serverresources.SubmissionResource" scope="prototype">
        <constructor-arg name="submissionStore" ref="submissionStore"/>
    </bean>

    <bean id="visibilityResource" class="edu.mit.puzzle.cube.core.serverresources.VisibilityResource" scope="prototype">
        <constructor-arg name="huntStatusStore" ref="huntStatusStore"/>
    </bean>

    <bean id="visibilitiesResource" class="edu.mit.puzzle.cube.core.serverresources.VisibilitiesResource" scope="prototype">
        <constructor-arg name="huntStatusStore" ref="huntStatusStore"/>
    </bean>

    <bean id="eventsResource" class="edu.mit.puzzle.cube.core.serverresources.EventsResource" scope="prototype">
        <constructor-arg name="eventFactory" ref="eventFactory"/>
        <constructor-arg name="eventProcessor" ref="coreEventProcessor"/>
    </bean>

    <bean id="teamResource" class="edu.mit.puzzle.cube.core.serverresources.TeamResource" scope="prototype">
        <constructor-arg name="huntStatusStore" ref="huntStatusStore"/>
    </bean>

    <bean id="submissionStore" class="edu.mit.puzzle.cube.core.model.SubmissionStore">
        <constructor-arg name="connectionFactory" ref="connectionFactory"/>
        <constructor-arg name="eventProcessor" ref="coreEventProcessor"/>
    </bean>

    <bean id="huntStatusStore" class="edu.mit.puzzle.cube.core.model.HuntStatusStore">
        <constructor-arg name="connectionFactory" ref="connectionFactory"/>
        <constructor-arg name="visibilityStatusSet" ref="visibilityStatusSet"/>
        <constructor-arg name="eventProcessor" ref="coreEventProcessor"/>
    </bean>

</beans>